# zaty_wordpress_login_authenticator
WordPressのログイン時にGoogle Authenticatorを使った二段階認証を実装します

# 使い方
1. ログイン後ユーザープロフィールで二段階認証を生成する
1. 生成したQRコードをGoogle Authenticatorで登録する
1. 次回ログイン時に二段階認証を求められます

有効化のチェックボックスをオフにすることで、シークレットコードを更新せずに二段階認証を無効化することができます。

# 注意
二段階認証のシークレットコードを失った場合は、復旧の手段を踏んで復旧作業を行なってください。

使用しているWordPressを管理権限のないサーバーで運用している場合、復旧が困難になります。

## シークレットコードを紛失した場合
- 管理権限のあるユーザーでログインし、シークレットコードを紛失したユーザーのプロフィールページにログイン。ページ下「二段階認証を有効化する」のチェックボックスのチェックを外す。
- WordPressを運用しているデータベース内のwp_usermetaテーブルの対応UserIDのwp_authenticator_codeを空白にする。
- functions.phpにて、delete_user_option（'authenticator_code',UserID）関数で情報を消す。

以上の方法でシークレットコードを紛失した場合でも復旧することが可能です。

# ToDo
- 総当たり攻撃対策で複数回の認証ミスでIPアドレスをBANする
- 二段階認証のシークレットコードを紛失したときのリセットプログラムを作成する
